# 调试"粘贴到编辑器"按钮不显示的问题

## ✅ 确认：代码已正确修改

文件 `apps/student-app/src/components/StudyRunner.tsx` 第 198 行：

```tsx
📋 粘贴到编辑器
```

代码确实存在！问题是浏览器没有加载到最新代码。

---

## 🔍 调试步骤

### 第一步：完全清除浏览器缓存

#### 方法 A：开发者工具强制刷新

1. 按 `F12` 打开开发者工具
2. **右键点击浏览器刷新按钮**
3. 选择 **"清空缓存并硬性重新加载"**

#### 方法 B：手动清除缓存

1. 按 `Ctrl + Shift + Delete`
2. 时间范围选择 **"时间不限"**
3. 勾选 **"缓存的图片和文件"**
4. 勾选 **"Cookie 和其他网站数据"**
5. 点击 **"清除数据"**
6. 关闭所有浏览器标签页
7. 重新打开浏览器
8. 访问 `http://localhost:5173/learn/python/maze_navigator/1`

---

### 第二步：检查实际加载的代码

#### 在浏览器开发者工具中：

1. 按 `F12` 打开开发者工具
2. 点击 **"Sources"** 标签页
3. 左侧展开：`localhost:5173` → `src` → `components`
4. 找到并点击 `StudyRunner.tsx`
5. 按 `Ctrl + F` 搜索 **"粘贴到编辑器"**
6. **如果找到** → 代码已加载，但可能有渲染问题
7. **如果找不到** → 浏览器加载的是旧代码，需要继续清缓存

---

### 第三步：检查控制台错误

在开发者工具的 **Console** 标签页：

1. 刷新页面
2. 查看是否有红色错误信息
3. 特别注意：
   - `SyntaxError` - 语法错误
   - `TypeError` - 类型错误
   - `ReferenceError` - 引用错误
4. 如果有错误，复制错误信息

---

### 第四步：检查 Network 请求

在开发者工具的 **Network** 标签页：

1. 勾选 **"Disable cache"** （禁用缓存）
2. 刷新页面
3. 在左侧列表中找到 `StudyRunner.tsx`
4. 点击它，查看 **Headers** 标签
5. 检查 **Status Code** 是否为 `200`
6. 查看 **Response** 标签中的代码
7. 搜索 **"粘贴到编辑器"** 看是否存在

---

### 第五步：使用无痕模式测试

1. 按 `Ctrl + Shift + N` 打开无痕窗口
2. 访问 `http://localhost:5173/learn/python/maze_navigator/1`
3. 查看按钮是否出现

如果在无痕模式下能看到，说明是浏览器缓存问题。

---

## 🛠️ 终极解决方案

如果上述方法都不行，尝试以下步骤：

### 方案 1：停止服务 → 删除构建缓存 → 重启

```powershell
# 1. 停止所有 Node 进程
Get-Process | Where-Object {$_.ProcessName -eq "node"} | Stop-Process -Force

# 2. 删除构建缓存
cd F:\project\kids-coding-platform\apps\student-app
Remove-Item -Recurse -Force node_modules\.vite -ErrorAction SilentlyContinue
Remove-Item -Recurse -Force dist -ErrorAction SilentlyContinue

# 3. 重新启动
cd F:\project\kids-coding-platform
.\start-studyrunner-test.ps1
```

### 方案 2：手动启动（更好的调试输出）

打开两个 PowerShell 窗口：

**窗口 1 - 启动 API：**

```powershell
cd F:\project\kids-coding-platform\server\api
pnpm dev
```

**窗口 2 - 启动学生端：**

```powershell
cd F:\project\kids-coding-platform\apps\student-app
pnpm dev
```

这样可以看到完整的输出日志。

---

## 📸 请提供以下信息

如果问题依然存在，请截图或复制以下信息：

1. **浏览器控制台（Console）** - 有无错误？
2. **Sources 标签页中 StudyRunner.tsx** - 搜索"粘贴到编辑器"的结果
3. **Network 标签页** - StudyRunner.tsx 的状态码
4. **实际看到的按钮** - 截图

---

## ✅ 预期结果

正确显示应该是：

```
代码编辑器
┌────────────────────────────────────────┐
│ [代码输入区域]                          │
└────────────────────────────────────────┘

┌────────────────────────────────────────┐
│ ▶️ 运行并判题                            │
│ 💡 查看参考答案                          │
│ 📋 粘贴到编辑器 ← 应该能看到这个          │
│ 🔄 重置代码                             │
└────────────────────────────────────────┘
```

**按钮状态：**

- 初始：📋 粘贴到编辑器（灰色，禁用）
- 点击"查看参考答案"后：📋 粘贴到编辑器（蓝色，可点击）

---

## 🎯 最快的测试方法

1. 按 `F12` 打开开发者工具
2. 在 Console 中输入：

```javascript
document.querySelectorAll('.btn').forEach((btn) => console.log(btn.textContent));
```

3. 按回车
4. 应该会输出所有按钮的文本，包括 "📋 粘贴到编辑器"

如果没有输出这个文本，说明组件确实没有渲染该按钮。
